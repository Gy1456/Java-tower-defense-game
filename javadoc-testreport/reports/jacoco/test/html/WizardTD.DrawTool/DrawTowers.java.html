<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DrawTowers.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">scaffold</a> &gt; <a href="index.source.html" class="el_package">WizardTD.DrawTool</a> &gt; <span class="el_source">DrawTowers.java</span></div><h1>DrawTowers.java</h1><pre class="source lang-java linenums">package WizardTD.DrawTool;
import WizardTD.Gamebase.GameSet;
import WizardTD.MODEL.*;
import processing.core.PImage;
import processing.core.PApplet;
import java.util.HashMap;

public class DrawTowers extends DrawTool{
    /**
     * Represents the game board where Towers are drawn.
     */
    private Board board;
    /**
     * Represents the game settings for controlling drawing behavior.
     */
    private GameSet set;
    /**
     * Represents the image used for rendering Towers.
     */
    private PImage pimage;
    /**
     * The constructor of DrawTowers,Initializes a DrawTowers object with the provided image mappings, game board, and game set.
     * @param maps  A HashMap of images used for rendering various elements.
     * @param board The game board containing towers to be drawn.
     * @param set   The game set containing game state information.
     */
    public DrawTowers(HashMap&lt;String, PImage&gt; maps,Board board,GameSet set){
<span class="fc" id="L28">        super(maps);</span>
<span class="fc" id="L29">        this.maps=maps;</span>
<span class="fc" id="L30">        this.board=board;</span>
<span class="fc" id="L31">        this.set=set;</span>
<span class="fc" id="L32">    }</span>
    /**
     * Draws the range upgrade level of a tower.
     * @param app        The PApplet used for drawing.
     * @param x          The x-coordinate of the tower.
     * @param y          The y-coordinate of the tower.
     * @param rangelevel The tower's range upgrade level.
     */
    public void drawrange(PApplet app,int x,int y,int rangelevel){
<span class="fc bfc" id="L41" title="All 2 branches covered.">        for(int i=0;i&lt;rangelevel;i++){</span>
<span class="fc" id="L42">            app.textSize(15);</span>
<span class="fc" id="L43">            app.fill(255, 0, 255);</span>
<span class="fc" id="L44">            app.text(&quot;o&quot;, x+i*5, y+7);</span>
        }
<span class="fc" id="L46">    }</span>
    /**
     * Draws the damage upgrade level of a tower.
     * @param app        The PApplet used for drawing.
     * @param x          The x-coordinate of the tower.
     * @param y          The y-coordinate of the tower.
     * @param powerlevel The tower's damage upgrade level.
     */
    public void drawdamage(PApplet app,int x,int y,int powerlevel){
<span class="fc bfc" id="L55" title="All 2 branches covered.">        for(int i=0;i&lt;powerlevel;i++){</span>
<span class="fc" id="L56">            app.textSize(10);</span>
<span class="fc" id="L57">            app.fill(255, 0, 255);</span>
<span class="fc" id="L58">            app.text(&quot;X&quot;, x+i*5, y+32);</span>
        }
<span class="fc" id="L60">    }</span>
    /**
     * Draws the speed upgrade level of a tower.
     * @param app        The PApplet used for drawing.
     * @param x          The x-coordinate of the tower.
     * @param y          The y-coordinate of the tower.
     * @param speedlevel The tower's speed upgrade level.
     */
    public void drawspeed(PApplet app,int x,int y,int speedlevel){
<span class="fc bfc" id="L69" title="All 2 branches covered.">        for(int i=0;i&lt;speedlevel;i++){</span>
<span class="fc" id="L70">            app. pushStyle();</span>
<span class="fc" id="L71">            app.stroke(135, 206, 235);</span>
<span class="fc" id="L72">            app.strokeWeight(speedlevel+2);</span>
<span class="fc" id="L73">            app.noFill();</span>
<span class="fc" id="L74">            app.rect(x+6, y+6, 20, 20);</span>
<span class="fc" id="L75">            app.popStyle();</span>
        }
<span class="fc" id="L77">    }</span>
    /**
     * Draws a label in the bottom right corner regarding tower information when a tower is selected.
     * @param app The PApplet used for drawing.
     */
    public void drawlabel(PApplet app){
<span class="fc bfc" id="L83" title="All 2 branches covered.">        if(!board.getselectedTowers().isEmpty()){</span>
<span class="fc bfc" id="L84" title="All 2 branches covered.">            for(Tower tower:board.getselectedTowers()){</span>
<span class="fc" id="L85">                double speedcost=0;</span>
<span class="fc" id="L86">                double rangecost=0;</span>
<span class="fc" id="L87">                double damagecost=0;</span>
<span class="fc" id="L88">                app.pushStyle();</span>
<span class="fc" id="L89">                app.noFill();</span>
<span class="fc" id="L90">                app.stroke(255, 204, 0);</span>
<span class="fc" id="L91">                app.strokeWeight(3);</span>
<span class="fc" id="L92">                app.ellipse(tower.getX()+16, tower.getY()+16, (float)tower.getrange()*2,</span>
<span class="fc" id="L93">                        (float)tower.getrange()*2);</span>
<span class="fc" id="L94">                app.popStyle();</span>
<span class="fc" id="L95">                app.fill(255);</span>
<span class="fc" id="L96">                app.rect(650, 530, 130, 50);</span>
<span class="fc" id="L97">                app.fill(0);</span>
<span class="fc" id="L98">                app.text(&quot;Upgrade cost&quot;, 660, 545);</span>
<span class="fc" id="L99">                app.fill(255);</span>
<span class="fc" id="L100">                app.rect(650, 580, 150, 70);</span>
<span class="fc" id="L101">                app.fill(0);</span>
<span class="pc bpc" id="L102" title="1 of 2 branches missed.">                if (board.getRangelevelupenable()) {</span>
<span class="fc" id="L103">                    rangecost = tower.getRangecost();</span>
<span class="fc" id="L104">                    app.text(&quot;range: &quot; +(int)rangecost, 660, 595);</span>
                }
<span class="pc bpc" id="L106" title="1 of 2 branches missed.">                if (board.getspeedlevelupenable()) {</span>
<span class="fc" id="L107">                    speedcost = tower.getSpeedcost();</span>
<span class="fc" id="L108">                    app.text(&quot;speed: &quot; + (int)speedcost, 660, 610);</span>
                }
<span class="pc bpc" id="L110" title="1 of 2 branches missed.">                if (board.getDamagelevelupenable()) {</span>
<span class="fc" id="L111">                    damagecost = tower.getDamagecost();</span>
<span class="fc" id="L112">                    app.text(&quot;damage: &quot; + (int)damagecost, 660, 625);</span>
                }
<span class="fc" id="L114">                app.fill(255);</span>
<span class="fc" id="L115">                app.rect(650, 630, 150, 40);</span>
<span class="fc" id="L116">                app.fill(0);</span>
<span class="fc" id="L117">                app.text(&quot;Total: &quot; + (int)(speedcost + rangecost + damagecost), 660, 650);</span>
<span class="fc" id="L118">            }</span>
        }
<span class="fc" id="L120">    }</span>
    /**
     * Draws towers on the game board along with their upgrades and labels.
     * @param app The PApplet used for drawing.
     */
    public void draw(PApplet app){
<span class="fc" id="L126">        float originalStrokeWeight = app.g.strokeWeight;</span>
<span class="fc" id="L127">        int originalFillColor = app.g.fillColor;</span>
<span class="fc" id="L128">        drawlabel(app);</span>
<span class="fc bfc" id="L129" title="All 2 branches covered.">        for(int i=0;i&lt;board.getTowers().size();i++){</span>
<span class="fc" id="L130">                int x=board.getTowers().get(i).getX();</span>
<span class="fc" id="L131">                int y=board.getTowers().get(i).getY();</span>
<span class="fc" id="L132">                int speedlevel=board.getTowers().get(i).getSpeed_level();</span>
<span class="fc" id="L133">                int rangelevel=board.getTowers().get(i).getRange_level();</span>
<span class="fc" id="L134">                int powerlevel=board.getTowers().get(i).getPower_level();</span>
<span class="pc bpc" id="L135" title="2 of 6 branches missed.">                if(speedlevel&lt;1||rangelevel&lt;1||powerlevel&lt;1){</span>
<span class="fc" id="L136">                    this.pimage = maps.get(&quot;tower0&quot;);</span>
<span class="fc" id="L137">                    app.image(pimage, x, y);</span>
<span class="fc" id="L138">                    drawspeed(app,x,y,speedlevel);</span>
<span class="fc" id="L139">                    drawrange(app,x,y,rangelevel);</span>
<span class="fc" id="L140">                    drawdamage(app,x,y,powerlevel);</span>
            }
<span class="pc bpc" id="L142" title="7 of 12 branches missed.">            else if((speedlevel&gt;=1||rangelevel&gt;=1||powerlevel&gt;=1)&amp;&amp;(speedlevel&lt;2||rangelevel&lt;2||powerlevel&lt;2)){</span>
<span class="fc" id="L143">                this.pimage = maps.get(&quot;tower1&quot;);</span>
<span class="fc" id="L144">                app.image(pimage, x, y);</span>
<span class="fc" id="L145">                drawspeed(app,x,y,speedlevel-1);</span>
<span class="fc" id="L146">                drawrange(app,x,y,rangelevel-1);</span>
<span class="fc" id="L147">                drawdamage(app,x,y,powerlevel-1);</span>
            }
<span class="pc bpc" id="L149" title="5 of 6 branches missed.">            else if(speedlevel&gt;=2||rangelevel&gt;=2||powerlevel&gt;=2){</span>
<span class="fc" id="L150">                this.pimage = maps.get(&quot;tower2&quot;);</span>
<span class="fc" id="L151">                app.image(pimage, x, y);</span>
<span class="fc" id="L152">                drawspeed(app,x,y,speedlevel-2);</span>
<span class="fc" id="L153">                drawrange(app,x,y,rangelevel-2);</span>
<span class="fc" id="L154">                drawdamage(app,x,y,powerlevel-2);</span>
            }
<span class="pc bpc" id="L156" title="1 of 4 branches missed.">                if(!(set.isGamepause()||set.isGamelose())) {</span>
<span class="fc" id="L157">                    board.getTowers().get(i).toweraction(set.isGameaccelerate());</span>
                }
        }
<span class="fc" id="L160">        app.strokeWeight(originalStrokeWeight);</span>
<span class="fc" id="L161">        app.fill(originalFillColor);</span>
<span class="fc" id="L162">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>